rm(list = ls())
library(igraph)
library(reshape2)
setwd("F:/RA/代码整理/Code 20240806/Extended Data Fig. 1/eFig. 1c")
d1<-read.csv("Extended Data Fig 1c (citsite first).csv")[,-1]
d2<-read.csv("Extended Data Fig 1c (citsite second).csv")[,-1]
table(colnames(d1)==colnames(d2));table(rownames(d1)==rownames(d2))
d1<-d1[,-1]
d2<-d2[,-1]
cor=sapply(1:ncol(d1),function(x){cor.test(d1[,x],d2[,x],method="spearman")[["estimate"]][["rho"]]})
plot(density(cor))
median<-median(cor)
cor2=density(cor)
cor3=data.frame(x=cor2$x,y=cor2$y)
cor1=data.frame(cor=cor)
library(ggplot2)
ggplot()+
geom_density(data=cor1, aes(x=cor),stat = "density", fill="pink")+
#geom_bar(data=cor3,aes(x=x,y=y),stat="identity", fill="transparent",color="black", alpha=.1)+
xlim(0.3,0.7)+
ylim(0,6)+
geom_vline(xintercept = 0.514,linetype=2,color="grey",size=1)+
theme_classic()
rm(list = ls())
data=read.csv("F:/RA/代码整理/Code 20240806/Extended Data Fig. 2/eFig. 2b,2d,2f/wilcox result.csv")
dat=data[data$PRA_HP_youwu=="wilcox",]%>%filter(PRA_HP_all=="up" & RAA_HP_all!="up")%>%arrange(p_PRA_HP_wilcox)%>%data.frame()
library(dplyr)
library(ComplexHeatmap)
library(circlize)
library(ggplot2)
rm(list = ls())
data=read.csv("F:/RA/代码整理/Code 20240806/Extended Data Fig. 2/eFig. 2b,2d,2f/wilcox result.csv")
dat=data[data$PRA_HP_youwu=="wilcox",]%>%filter(PRA_HP_all=="up" & RAA_HP_all!="up")%>%arrange(p_PRA_HP_wilcox)%>%data.frame()
rownames(dat)=dat$position
dat1=dat[1:10,c("median_HP", "median_PRA", "median_RA_A")]
col_fun = colorRamp2(c(-1,0, 1), c("#5D669F","white","#AF322F"))
top_annotation = HeatmapAnnotation(df=data.frame(group=c("Health","preRA","RA")),
col = list(group=c(RA="#BF5960",Health="#6F99AD",preRA="#F9A363")))
Heatmap(t(scale(t(dat1))),col=col_fun,
rect_gp = gpar(col="white", lwd=3),
top_annotation = top_annotation,
cluster_rows = F, cluster_columns = F,
show_heatmap_legend = T,
border = F, show_column_names = F,
show_row_names = T, column_title = NULL)
setwd("F:/RA/代码整理/Code 20240806/Extended Data Fig. 2/eFig. 2b,2d,2f")
pdf("Fig 2b left.pdf", width = 5, height = 4)
Heatmap(t(scale(t(dat1))),col=col_fun,
rect_gp = gpar(col="white", lwd=3),
top_annotation = top_annotation,
cluster_rows = F, cluster_columns = F,
show_heatmap_legend = T,
border = F, show_column_names = F,
show_row_names = T, column_title = NULL)
dev.off()
dat=data[data$RAA_HP_youwu=="wilcox",]%>%filter(RAA_HP_all=="up" & PRA_HP_all!="up")%>%arrange(p_RAA_HP_wilcox)%>%data.frame()
rownames(dat)=dat$position
dat1=dat[1:10,c("median_HP", "median_PRA", "median_RA_A")]
col_fun = colorRamp2(c(-1,0, 1), c("#5D669F","white","#AF322F"))
top_annotation = HeatmapAnnotation(df=data.frame(group=c("Health","preRA","RA")),
col = list(group=c(RA="#BF5960",Health="#6F99AD",preRA="#F9A363")))
Heatmap(t(scale(t(dat1))),col=col_fun,
rect_gp = gpar(col="white", lwd=3),
top_annotation = top_annotation,
cluster_rows = F, cluster_columns = F,
show_heatmap_legend = T,
border = F, show_column_names = F,
show_row_names = T, column_title = NULL)
pdf("Fig 2d left.pdf", width = 5, height = 4)
Heatmap(t(scale(t(dat1))),col=col_fun,
rect_gp = gpar(col="white", lwd=3),
top_annotation = top_annotation,
cluster_rows = F, cluster_columns = F,
show_heatmap_legend = T,
border = F, show_column_names = F,
show_row_names = T, column_title = NULL)
dev.off()
dat=data[data$RAA_HP_youwu=="wilcox" & data$PRA_HP_youwu=="wilcox",]%>%filter(RAA_HP_all=="up" & PRA_HP_all=="up")%>%arrange(p_RAA_HP_wilcox,p_PRA_HP_wilcox)%>%data.frame()
rownames(dat)=dat$position
dat1=dat[1:10,c("median_HP", "median_PRA", "median_RA_A")]
col_fun = colorRamp2(c(-1,0, 1), c("#5D669F","white","#AF322F"))
top_annotation = HeatmapAnnotation(df=data.frame(group=c("Health","preRA","RA")),
col = list(group=c(RA="#BF5960",Health="#6F99AD",preRA="#F9A363")))
pdf("Fig 2f left.pdf", width = 5, height = 4)
Heatmap(t(scale(t(dat1))),col=col_fun,
rect_gp = gpar(col="white", lwd=3),
top_annotation = top_annotation,
cluster_rows = F, cluster_columns = F,
show_heatmap_legend = T,
border = F, show_column_names = F,
show_row_names = T, column_title = NULL)
dev.off()
dat=data[data$PRA_HP_youwu=="wilcox",]%>%filter(PRA_HP_all=="up" & RAA_HP_all!="up")%>%arrange(p_PRA_HP_wilcox)%>%data.frame()
dat1=dat[1:10,]%>%mutate(order=letters[10:1])
names(dat1)
dat1$order = paste(dat1$order, dat1$position)
ggplot(dat1, aes(-log10(p_PRA_HP_wilcox),order, fill=`fc_PRA_HP`))+
geom_bar(stat="identity", width=.01, color="black", fill="black")+
geom_point(shape=21, size=5)+
scale_size(breaks=c(16,19,21), range=c(2,5.5),name="")+
scale_fill_gradient2(high="#F9A363", low="white",name="", breaks=c(0.5,1.5,2.5))+
theme_minimal()+
theme(axis.line.x = element_line(color="black"),
axis.ticks.x = element_line(color="black"))
ggsave("Fig 2b right.pdf", width = 4, height = 3)
dat=data[data$RAA_HP_youwu=="wilcox",]%>%filter(RAA_HP_all=="up" & PRA_HP_all!="up")%>%arrange(p_RAA_HP_wilcox)%>%data.frame()
dat1=dat[1:10,]%>%mutate(order=letters[10:1])
names(dat1)
dat1$order = paste(dat1$order, dat1$position)
ggplot(dat1, aes(-log10(p_RAA_HP_wilcox),order, fill=`fc_RAA_HP`))+
geom_bar(stat="identity", width=.01, color="black", fill="black")+
geom_point(shape=21, size=5)+
scale_size(breaks=c(16,19,21), range=c(2,5.5),name="")+
scale_fill_gradient2(high="#F9A363", low="white",name="", breaks=c(0.3,0.4,0.5))+
theme_minimal()+
theme(axis.line.x = element_line(color="black"),
axis.ticks.x = element_line(color="black"))
ggsave("Fig 2d right.pdf", width = 4.3, height = 3)
dat=data[data$RAA_HP_youwu=="wilcox" & data$PRA_HP_youwu=="wilcox",]%>%filter(RAA_HP_all=="up" & PRA_HP_all=="up")%>%arrange(p_RAA_HP_wilcox,p_PRA_HP_wilcox)%>%data.frame()
dat1=dat[1:10,]%>%mutate(order=letters[10:1])
names(dat1)
dat1$order = paste(dat1$order, dat1$position)
d_PRA = dat1[,c("order","p_PRA_HP_wilcox","fc_PRA_HP")]; colnames(d_PRA)[2:3]=c("p","log2fc"); d_PRA$log2fc = -d_PRA$log2fc
d_RAA = dat1[,c("order","p_RAA_HP_wilcox","fc_RAA_HP")]; colnames(d_RAA)[2:3]=c("p","log2fc")
dat2=rbind(d_PRA, d_RAA)
ggplot(dat2, aes(log2fc,order, fill=-log10(p)))+
geom_bar(stat="identity", width=.01, color="black", fill="black")+
geom_point(shape=21, size=5)+
geom_vline(xintercept = 0,linetype=2)+
scale_size(breaks=c(16,19,21), range=c(2,5.5),name="")+
scale_fill_gradient2(high="#AF322F", low="white",name="", breaks=c(15,25,35))+
theme_minimal()+
theme(axis.line.x = element_line(color="black"),
axis.ticks.x = element_line(color="black"))
ggsave("Fig 2f right.pdf", width = 4, height = 3)
setwd("F:/RA/代码整理/Code 20240806/Extended Data Fig. 2/eFig. 2a,2c,2e,2g")
library(dplyr)
library(ggplot2)
library(ggpubr)
rm(list = ls())
data=data.table::fread("PRA_up_only31 GOMF.txt")%>%arrange(PValue) %>% filter(PValue<0.05)
rm(list = ls())
data=data.table::fread("PRA_up_only31 GOBP.txt")%>%arrange(PValue) %>% filter(PValue<0.05)
dat=data[1:10,]%>%arrange(Count)%>%mutate(order=letters[1:10])
names(dat)
ggplot(dat, aes(Count, order, fill=-log10(PValue)))+
geom_bar(stat="identity", width = .6, color="transparent")+
scale_size(range=c(2,5))+
scale_fill_gradient(high="#FCA305", low="#A0CEE2", breaks = c(3,5,7))+
scale_x_continuous(expand = c(0,0), breaks = c(0,2,4,6,8))+
theme_minimal()+
theme(axis.line = element_line(linewidth=.8, color="black"),
axis.ticks = element_line(linewidth=.8, color="black"),
axis.ticks.length = unit(1.25,"mm"))
ggsave("eFig 2a.pdf", width = 4.5, height = 4)
dat$order1 = paste(dat$order, dat$Term)
ggplot(dat, aes(Count, order1, fill=-log10(PValue)))+
geom_bar(stat="identity", width = .6, color="transparent")+
scale_size(range=c(2,5))+
scale_fill_gradient(high="#FCA305", low="#A0CEE2", breaks = c(3,5,7))+
scale_x_continuous(expand = c(0,0), breaks = c(0,2,4,6,8))+
theme_minimal()+
theme(axis.line = element_line(linewidth=.8, color="black"),
axis.ticks = element_line(linewidth=.8, color="black"),
axis.ticks.length = unit(1.25,"mm"))
ggsave("eFig 2a.pdf", width = 7.5, height = 3)
rm(list = ls())
data=data.table::fread("RAA_up_only24 GOBP.txt")%>%arrange(PValue) %>% filter(PValue<0.05)
dat=data[1:10,]%>%arrange(Count)%>%mutate(order=letters[1:10])
names(dat)
dat$order1 = paste(dat$order, dat$Term)
ggplot(dat, aes(Count, order1, fill=-log10(PValue)))+
geom_bar(stat="identity", width = .6, color="transparent")+
scale_size(range=c(2,5))+
scale_fill_gradient(high="#FCA305", low="#A0CEE2", breaks = c(1.6,2,2.4,2.8))+
scale_x_continuous(expand = c(0,0), breaks = c(0,1,2,3))+
theme_minimal()+
theme(axis.line = element_line(linewidth=.8, color="black"),
axis.ticks = element_line(linewidth=.8, color="black"),
axis.ticks.length = unit(1.25,"mm"))
ggsave("eFig 2c.pdf", width = 7, height = 3)
rm(list = ls())
data=data.table::fread("both_up_PRA_RAA70 GOBP.txt")%>%arrange(PValue) %>% filter(PValue<0.05)
dat=data[1:10,]%>%arrange(Count)%>%mutate(order=letters[1:10])
names(dat)
dat$order1 = paste(dat$order, dat$Term)
ggplot(dat, aes(Count, order1, fill=-log10(PValue)))+
geom_bar(stat="identity", width = .6, color="transparent")+
scale_size(range=c(2,5))+
scale_fill_gradient(high="#FCA305", low="#A0CEE2", breaks=c(4,6,8))+
scale_x_continuous(expand = c(0,0), breaks = c(0,2,4,6))+
theme_minimal()+
theme(axis.line = element_line(linewidth=.8, color="black"),
axis.ticks = element_line(linewidth=.8, color="black"),
axis.ticks.length = unit(1.25,"mm"))
ggsave("eFig 2e.pdf", width = 7, height = 3)
rm(list = ls())
data=data.table::fread("PRA_down_only20 GOBP.txt")%>%arrange(PValue) %>% filter(PValue<0.05)
d1=data[1:5,]%>%arrange(Count)%>%mutate(order=letters[1:5])
names(d1)
data=data.table::fread("both_down_PRA_RAA32 GOBP.txt")%>%arrange(PValue) %>% filter(PValue<0.05)
d2=data[1:5,]%>%arrange(Count)%>%mutate(order=letters[1:5])
names(d2)
dat = rbind(d1%>%mutate(type="PRA_down_only20 GOBP"),d2%>%mutate(type="Xboth_down_PRA_RAA32 GOBP"))
dat$order=paste(dat$type, dat$order)
ggplot(dat, aes(Count, order, fill=-log10(PValue)))+
geom_bar(stat="identity", width = .6, color="transparent")+
scale_size(range=c(2,5))+
scale_fill_gradient(high="#FCA305", low="#A0CEE2", breaks=c(2,3,4,5))+
scale_x_continuous(expand = c(0,0), breaks = c(0,2,4,6))+
theme_minimal()+
theme(axis.line = element_line(linewidth=.8, color="black"),
axis.ticks = element_line(linewidth=.8, color="black"),
axis.ticks.length = unit(1.25,"mm"))
dat$order1 = paste(dat$order, dat$Term)
ggplot(dat, aes(Count, order1, fill=-log10(PValue)))+
geom_bar(stat="identity", width = .6, color="transparent")+
scale_size(range=c(2,5))+
scale_fill_gradient(high="#FCA305", low="#A0CEE2", breaks=c(2,3,4,5))+
scale_x_continuous(expand = c(0,0), breaks = c(0,2,4,6))+
theme_minimal()+
theme(axis.line = element_line(linewidth=.8, color="black"),
axis.ticks = element_line(linewidth=.8, color="black"),
axis.ticks.length = unit(1.25,"mm"))
ggsave("eFig 2g.pdf", width = 10, height = 3)
